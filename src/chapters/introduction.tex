\xchapter{Introduction}{}

Programmers often have to choose between tabs and spaces, between \texttt{while} loops and \texttt{for} loops, between positioning the open bracket in the next line or in the current line, etc. These are choices that can be regarded as their coding styles. Are these choices distinguishing features? In this chapter we will discuss what is style-based source code authorship identification, what challenges it poses, what has been done and what it is useful for. We will also introduce our contributions on the subject.

\section{Biometrics and Coding Style}

Biometrics is the field of computer vision that studies how certain human characteristics can be used to distinguish individuals. Even though physiological characteristics such as fingerprint, iris and face are probably the first ones that come to mind, the study of behavioral characteristics such as typing rhythm, voice, signature and writing style have brought new less intrusive means of distinguishing people. Even though using behavioral characteristics effectively has been made possible throughout the years, the fact that behavior is way more susceptible to change than physiological characteristics poses a big challenge. % TODO: maybe cite guide_bio in this paragraph?

% TODO: paragrafo sobre behavior "coding style"

Identifying authors of texts based on their writing styles is not a new topic \cite{mendenhall}. Throughout the years, computing has evolved and machine learning has reached its peek, making its way through writing style recognition. \citeonline{text_recognition} made it possible to identify the author of a text among tens of thousands of writers. It wasn't long until we were able to distinguish programmers by their coding styles \cite{caliskan_2015}.

\section{Motivation}

Throughout this work, we mainly consider the task of an investigator interested in deciding whether two anonymous pieces of code were authored by the same programmer or not. The actual authors of these pieces of code may be unknown to the investigator. Also, these codes may aim to solve different problems, therefore the investigator intends to distinguish them solely based on stylistic features of such pieces.

We also consider easier scenarios where the set of possible authors are known to the investigator and labeled samples from this set are available. % TODO: link to section where these are formulated

We approach these problems from a deep learning perspective, training a deep neural model that can be subsequently used to resolve authorship of source codes and applying it to the different scenarios an investigator can face.

\section{Applications}

Resolving source code authorship has a few real-world applications both in industry and academy. Although we haven't directly studied those, in this section we briefly describe a few of them. In section (...) we also describe how the experimental formulations we propose in section (...) are related to each of them.

\subsection{Plagiarism Detection}

% TODO: alguma referencia q reforce esse paragrafo?
Plagiarism can be generally defined as the unauthorized re-use of the work of another individual. Source code plagiarism is a widespread problem in academic institutions. Checking for plagiarism manually is time-consuming and not extremely effective, becoming impractical as the size of the codebase increases.

Although automatic source code plagiarism detection is a recurring and well-studied problem \cite{plag_survey}, the approaches consolidated by widely used tools such as MOSS \cite{moss}, Sherlock and JPlag \cite{jplag} are mainly based on code similarity metrics which are greatly correlated to the task the code was written to solve.% TODO: refer to sherlock

For example, let's consider the specific case of \textit{ghostwriting}, where the code the individual claims to be of his authorship was neither written by him nor copied from a colleague, but was actually written by another person (a former student, for example).  It may not be possible to compare the suspicious code with another code by the same author, since the ghostwriter may actually be unknown. On the other hand, if pieces of code of the accused party are available, it's possible to determine if his coding style matches the coding style present in the suspicious code.

Also, an analyst may strongly suspect that a piece of code a programmer claims to be of his authorship is actually not, but have no clue of who the actual author might be. This can be modeled as a binary classification problem where positive samples are other pieces of code of the same author and negative samples are pieces from unrelated programmers. We propose another approach to this problem in (...). % TODO: refer to formulation sections

\subsection{Copyright Infringement}

Software forensics is the science of examining source code and binary code in order to identify, preserve, analyze and present facts and opinions about pieces of software. Although it can also be used in civil proceedings, it's most often associated with the investigation of a wide variety of computer crimes, one of which is copyright infringement.

Code correlation analysis plays an important role at copyright disputes. In this case, an analyst has labeled codes from the involved parties and the task of determining if there was infringement or not.

\subsection{Cyber Attack Identification}

Cyber attack identification is a powerful application of software forensics in cyber security. Files left behind by an intruder during a cyber attack may have just enough information for an analyst to identify who the intruder is or to relate such an attack to a previous incident. Therefore, comparing the coding style of the attacker to those of authors of previous attacks and authors of public code repositories is of great interest to the analyst.

% TODO: extend with samsa ransomware case

\subsection{Exposing Anonymous Programmers}

Although there are many helpful applications of source code authorship identification, systems capable of de-anonymizing programmers pose a threat to those who want to remain anonymous, in special for anonymous open source contributors \cite{gitblame}. There may be good reasons for a programmer to be anonymous, like working in a software a hostile government doesn't like. 

An example of a famous open source anonymous programmer is Bitcoin's creator, Satoshi Nakamoto. For example, if we had a set of labeled codes from programmers that are likely to be Nakamoto, we could try to match their coding style to the early versions of Bitcoin, of course, assuming that Nakamoto didn't try to obfuscate his own coding style.

\section{Challenges}
%TODO: citar aqui ou em related work?

Although comparison metrics have proved to work well for source codes, extracting features that encode the author's style and, therefore, are independent of the task being solved have proved to be challenging. For example, features such as methods and variables names can often be misleading. This task gets even more challenging as we need to select features that are steady across different programs and capable of distinguishing between programmers. In this work, we propose an end-to-end model that solves this problem.

Also, the environment the programmer is inserted can heavily affect the difficulty of the task. For example, in projects that have a rigid style guide to be followed, much less of the programmer's own coding style might prevail. We don't study the impact of such environments in this work. Moreover, in multi-contributor projects, usually powered by VCS (version control systems), certain pieces of code can contain contributions of many authors, turning the task of relating a single author to the style present on such piece very hard. Although we believe our contributions can be applied to multi-contributor environments, we leave this for future work.

In each of the mentioned applications, the claimed author may act adversarially and try to actively modify the coding style of the program. In the ghostwriting scenario, the involved parties may act together to make the style of the code written by one to match the other's. During a cyber attack development, an attacker may explicitly try to hide his own coding style. In a copyright infringement, the suspect may modify the code to match his own style. In this work, adversary interference is not considered.

\section{Related Work}

In this section, we describe how style-based source code authorship attribution has evolved throughout the years. We also briefly mention key works in the area of plain-text authorship attribution. While the two domains have different feature sets and different classification techniques have been applied to them, recent work in both areas are closely related. Moreover, we describe how deep learning growth might make works in these areas converge in the future.

\subsection{Source Code Authorship Attribution}

\citeonline{spafford} were among the first that suggested attributing source code based on style. Even though they suggested a handful of features, they did not propose an automated method nor a thorough analysis on how those features were useful. \citeonline{hypothesis} examined the conjecture that programmers are unique and that this uniqueness can be observed in the code they write. They conducted an experiment with programmers and graduate students, and found that programmers do have distinguishable style features which they use consistently.

Ranking approaches to source code authorship attribution were proposed by \citeonline{burrows_ngrams,burrows_repo,burrows_ir} and \citeonline{fran_byte}. \citeauthoronline{burrows_ngrams} used an information retrieval technique to solve the task, obtaining token-level n-gram representations of the source codes, building an index from these representations and querying that index for programs with unknown authors. The authors of the top-ranked programs were considered the authors of the queried program. \citeauthoronline{fran_byte} used byte-level n-gram features to tackle the problem. An author profile is composed of the most frequent n-grams in training data of that author. Then, the author of an unclaimed program is considered the one with the most common n-grams to this code. Both works achieved high accuracy on very small suspect sets but didn't scale well.

Use of ASTs (abstract syntax trees) for authorship attribution was first introduced by \citeonline{pelin}. \citeonline{caliskan_2015} have proposed using fuzzy ASTs and random forests to classify authorship of source code. Moreover, they proposed a coding style feature set for C/C++ source codes and a dataset for authorship attribution, based on Google Code Jam, which is a programming competition that resembles laboratory conditions. \citeonline{gitblame} showed that \citeauthoronline{caliskan_2015} results could be extended to previously unexplored conditions, by adapting their techniques to work for small blocks of code of GitHub repositories.

\citeonline{macdonell} introduced neural networks to the subject by using feed-forward neural networks and multiple discriminant analysis to attribute source codes. \citeonline{bandara} studied how deep neural networks could be competitive to previous methods given enough training data.

\subsection{Text Authorship Attribution}

Plain text authorship attribution has been consistently studied over the last few decades \cite{survey_text_recognition}. Most previous studies used stylometric analysis techniques for attributing authorship of literary texts \cite{stylometric,text_recognition}. As Internet has grown, the availability of plain text data has increased. Importance of attributing short texts, like SMS, tweets, etc. has arisen from forensics applications. 

\citeonline{dl_text_recognition} showed how deep learning methods can leverage from data availability, using such techniques to classify news authorship. \citeonline{cnn_text_recognition} showed how CNNs (convolutional neural networks) could be used to classify authorship of short texts, like reddit comments and tweets.

\subsection{Deep Learning}

%TODO: end to end deep learning

\section{Contribution}

In this work, we introduce the concept of \textit{coding style descriptors}, which are high dimensional representations that capture distinguishing stylistic features of a source code. We propose an end-to-end deep model that produces coding style descriptors from source code. Then, we study how the generated descriptors encode meaningful properties to the source code attribution problem by solving many of its variations.

We also introduce the Codeforces dataset for source code attribution, a C++ dataset with more than 30,000 samples extracted from Codeforces, a website specialized in holding online programming competitions. We briefly describe how the dataset was constructed and how it differs from previously published datasets.